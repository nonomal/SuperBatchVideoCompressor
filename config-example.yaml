# SBVC (Super Batch Video Compressor) é…ç½®æ–‡ä»¶ç¤ºä¾‹
# å¤åˆ¶æ­¤æ–‡ä»¶ä¸º config.yaml å¹¶æ ¹æ®éœ€è¦ä¿®æ”¹
# ä¼˜å…ˆçº§ï¼šå‘½ä»¤è¡Œå‚æ•° > é…ç½®æ–‡ä»¶ > ç¨‹åºé»˜è®¤å€¼
# è¯´æ˜ï¼šå¤§éƒ¨åˆ†é€‰é¡¹åœ¨ä»£ç é‡Œæœ‰å¯¹åº”å…œåº•å€¼ï¼ˆè§ src/config/defaults.pyï¼‰ï¼Œ
#      æœªè®¾ç½®æ—¶ä¼šè‡ªåŠ¨ä½¿ç”¨è¿™äº›é»˜è®¤å€¼ã€‚

# ============================================================
# è·¯å¾„é…ç½®
# ============================================================
paths:
  # Linux/macOS è·¯å¾„ç¤ºä¾‹ï¼š
  input: "/path/to/input"   # è¾“å…¥ç›®å½•
  output: "/path/to/output" # è¾“å‡ºç›®å½•
  log: "/path/to/logs"      # æ—¥å¿—ç›®å½•ï¼ˆç¨‹åºä¼šåˆ›å»ºï¼‰

  # Windows è·¯å¾„ç¤ºä¾‹ï¼ˆå–æ¶ˆæ³¨é‡Šå¹¶ä¿®æ”¹ï¼‰ï¼š
  # input: "F:/lada/output"    # æ¨èä½¿ç”¨æ­£æ–œæ 
  # output: "F:/lada/pre"      # æˆ–ä½¿ç”¨åŒåæ–œæ  "F:\\lada\\pre"
  # log: "I:/BVC"              # æˆ–ä½¿ç”¨åŸå§‹å­—ç¬¦ä¸²ï¼ˆPythonï¼‰

# ============================================================
# ç¼–ç é…ç½®
# ============================================================
encoding:
  # è¾“å‡ºç¼–ç æ ¼å¼: hevc, avc, av1
  codec: hevc
  
  # éŸ³é¢‘ç ç‡ï¼ˆä¿æŒ 128k å…¼å®¹æ€§è¾ƒå¥½ï¼‰
  audio_bitrate: "128k"
  
  # ç ç‡è®¡ç®—
  bitrate:
    # å¼ºåˆ¶ç ç‡ (0 = è‡ªåŠ¨è®¡ç®—ï¼›>0 æ—¶ç›´æ¥ç”¨æ­¤å€¼)
    forced: 0
    # å‹ç¼©æ¯”ä¾‹ï¼ˆè‡ªåŠ¨æ¨¡å¼ä¸‹ï¼šç›®æ ‡ç ç‡ = åŸå§‹ç ç‡ * ratioï¼‰
    ratio: 0.5
    # æœ€å°ç ç‡ (bps) â€”â€” é˜²æ­¢è¿‡åº¦å‹ç¼©
    min: 500000
    # åˆ†è¾¨ç‡å°é¡¶é€»è¾‘åœ¨ä»£ç ä¸­ï¼šçŸ­è¾¹<=720/1080/1440/å…¶ä»– -> 1.5/3/5/9 Mbps

# ============================================================
# å¸§ç‡é™åˆ¶
# ============================================================
fps:
  max: 30                            # è½¯ä»¶é™å¸§çš„ä¸Šé™
  limit_on_software_decode: true     # è½¯ä»¶è§£ç æ—¶é™å¸§
  limit_on_software_encode: true     # è½¯ä»¶ç¼–ç æ—¶é™å¸§

# ============================================================
# ç¼–ç å™¨é…ç½® (æ··åˆè°ƒåº¦æ ¸å¿ƒ)
# ============================================================
encoders:
  # å¯ç”¨çš„ç¼–ç å™¨åˆ—è¡¨ (æŒ‰ä¼˜å…ˆçº§æ’åº)
  # ğŸ“ ä¸åŒå¹³å°æ¨èé…ç½®ï¼š
  #   Windows (NVIDIA): ["nvenc"]
  #   Windows (Intel):  ["qsv"]
  #   macOS:           ["videotoolbox"]
  #   Linux (NVIDIA):  ["nvenc"]
  #   æ··åˆ:            ["nvenc", "qsv"] æˆ– ["nvenc", "videotoolbox"]
  enabled:
    - nvenc
    - qsv

  # CPU ç¼–ç å™¨ä½œä¸ºå…œåº•ï¼ˆæ¨èå¼€å¯ï¼Œæé«˜æˆåŠŸç‡ï¼‰
  cpu_fallback: true

  # NVIDIA NVENC é…ç½®
  nvenc:
    enabled: true
    max_concurrent: 3    # å•å¡å¹¶å‘ä¸Šé™ï¼ˆ3-6æ ¹æ®æ˜¾å­˜è°ƒæ•´ï¼‰
    device: -1           # GPUè®¾å¤‡IDï¼Œ-1è¡¨ç¤ºè‡ªåŠ¨é€‰æ‹©
    fallback_to: qsv     # å¤±è´¥æ—¶å›é€€ç¼–ç å™¨

  # Intel QSV é…ç½®
  qsv:
    enabled: true
    max_concurrent: 2    # QSVå¹¶å‘ä¸Šé™
    device: null         # null è¡¨ç¤ºé»˜è®¤è®¾å¤‡
    fallback_to: cpu     # å¤±è´¥æ—¶å›é€€åˆ°CPU

  # Apple VideoToolbox é…ç½® (ä»… macOS)
  videotoolbox:
    enabled: false       # macOSä¸Šè®¾ä¸ºtrue
    max_concurrent: 3
    fallback_to: cpu

  # CPU è½¯ä»¶ç¼–ç é…ç½®
  cpu:
    enabled: true
    max_concurrent: 4    # CPUå¹¶å‘æ•°ï¼ˆæ ¹æ®æ ¸å¿ƒæ•°è°ƒæ•´ï¼‰
    preset: medium       # ç¼–ç é¢„è®¾ï¼šultrafast/fast/medium/slow

# ============================================================
# è°ƒåº¦é…ç½®ï¼ˆä»…åœ¨ --multi-gpu å¤šç¼–ç å™¨æ¨¡å¼ä¸‹ç”Ÿæ•ˆï¼‰
# ============================================================
scheduler:
  max_total_concurrent: 6              # æ€»å¹¶å‘ä¸Šé™ï¼ˆè·¨æ‰€æœ‰ç¼–ç å™¨ï¼‰
  strategy: priority                   # priority | least_loaded | round_robin
  retry_per_encoder: 1                 # æ¯ç§ç¼–ç å™¨çš„é‡è¯•æ¬¡æ•°ï¼ˆé¢„ç•™å­—æ®µï¼‰

# ============================================================
# æ–‡ä»¶å¤„ç†
# ============================================================
files:
  min_size_mb: 100           # å°äºæ­¤å¤§å°è·³è¿‡ï¼ˆé¿å…å¤„ç†å°æ–‡ä»¶ï¼‰
  keep_structure: true       # ä¿æŒåŸç›®å½•ç»“æ„åˆ°è¾“å‡º
  skip_existing: true        # ç›®æ ‡æ–‡ä»¶å­˜åœ¨åˆ™è·³è¿‡ï¼ˆé¿å…é‡å¤å¤„ç†ï¼‰

# ============================================================
# ğŸ“ å¸¸è§ä½¿ç”¨åœºæ™¯é…ç½®ç¤ºä¾‹
# ============================================================
#
# ã€åœºæ™¯1ï¼šå•GPU NVENCï¼Œå…¼å®¹æ—§SBVC.pyç¨‹åºã€‘
# encoders:
#   enabled: ["nvenc"]
#   cpu_fallback: false
#   nvenc:
#     max_concurrent: 3
#
# ã€åœºæ™¯2ï¼šå¤šGPUæˆ–æ··åˆç¡¬ä»¶ï¼Œå¯ç”¨æ™ºèƒ½è°ƒåº¦ã€‘
# å‘½ä»¤ï¼špython main.py --multi-gpu
# encoders:
#   enabled: ["nvenc", "qsv"]
#   cpu_fallback: true
# scheduler:
#   strategy: least_loaded
#   max_total_concurrent: 6
#
# ã€åœºæ™¯3ï¼šä»…CPUè½¯ä»¶ç¼–ç ï¼ˆæ— ç¡¬ä»¶åŠ é€Ÿï¼‰ã€‘
# å‘½ä»¤ï¼špython main.py --hw-accel none --enable-software-fallback
# æˆ–ç›´æ¥åœ¨é…ç½®ä¸­ï¼š
# encoders:
#   enabled: []
#   cpu_fallback: true
#
# ã€åœºæ™¯4ï¼šmacOS VideoToolboxã€‘
# encoders:
#   enabled: ["videotoolbox"]
#   cpu_fallback: true
#   videotoolbox:
#     enabled: true
#     max_concurrent: 3
#
# ã€åœºæ™¯5ï¼šé«˜ååé‡é…ç½®ï¼ˆå¤šå¡/é«˜æ€§èƒ½æœåŠ¡å™¨ï¼‰ã€‘
# encoders:
#   nvenc:
#     max_concurrent: 6
#   qsv:
#     max_concurrent: 4
#   cpu:
#     max_concurrent: 8
# scheduler:
#   max_total_concurrent: 12
#   strategy: least_loaded
