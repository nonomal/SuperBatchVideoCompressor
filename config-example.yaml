# SBVC (Super Batch Video Compressor) é…ç½®æ–‡ä»¶ç¤ºä¾‹
# å¤åˆ¶æ­¤æ–‡ä»¶ä¸º config.yaml å¹¶æ ¹æ®éœ€è¦ä¿®æ”¹
# ä¼˜å…ˆçº§ï¼šå‘½ä»¤è¡Œå‚æ•° > é…ç½®æ–‡ä»¶ > ç¨‹åºé»˜è®¤å€¼

# ============================================================
# è·¯å¾„é…ç½®
# ============================================================
paths:
  # Linux/macOS è·¯å¾„ç¤ºä¾‹ï¼š
  input: "/path/to/input"   # è¾“å…¥ç›®å½•
  output: "/path/to/output" # è¾“å‡ºç›®å½•
  log: "/path/to/logs"      # æ—¥å¿—ç›®å½•ï¼ˆç¨‹åºä¼šåˆ›å»ºï¼‰

  # Windows è·¯å¾„ç¤ºä¾‹ï¼ˆå–æ¶ˆæ³¨é‡Šå¹¶ä¿®æ”¹ï¼‰ï¼š
  # input: "F:/lada/output"    # æ¨èä½¿ç”¨æ­£æ–œæ 
  # output: "F:/lada/pre"      # æˆ–ä½¿ç”¨åŒåæ–œæ  "F:\\lada\\pre"
  # log: "I:/BVC"

# ============================================================
# ç¼–ç é…ç½®
# ============================================================
encoding:
  # è¾“å‡ºç¼–ç æ ¼å¼: hevc, avc, av1
  codec: hevc
  
  # éŸ³é¢‘ç ç‡ï¼ˆä¿æŒ 128k å…¼å®¹æ€§è¾ƒå¥½ï¼‰
  audio_bitrate: "128k"
  
  # ç ç‡è®¡ç®—
  bitrate:
    # å¼ºåˆ¶ç ç‡ (0 = è‡ªåŠ¨è®¡ç®—ï¼›>0 æ—¶ç›´æ¥ç”¨æ­¤å€¼)
    forced: 0
    # å‹ç¼©æ¯”ä¾‹ï¼ˆè‡ªåŠ¨æ¨¡å¼ä¸‹ï¼šç›®æ ‡ç ç‡ = åŸå§‹ç ç‡ * ratioï¼‰
    ratio: 0.5
    # æœ€å°ç ç‡ (bps) â€”â€” é˜²æ­¢è¿‡åº¦å‹ç¼©
    min: 500000
    # æ ¹æ®åˆ†è¾¨ç‡çš„æœ€å¤§ç ç‡å°é¡¶ï¼ˆbpsï¼‰
    max_by_resolution:
      720: 1500000    # 720p: 1.5 Mbps
      1080: 3000000   # 1080p: 3 Mbps
      1440: 5000000   # 1440p (2K): 5 Mbps
      2160: 9000000   # 4K: 9 Mbps

# ============================================================
# å¸§ç‡é™åˆ¶
# ============================================================
fps:
  max: 30                            # è½¯ä»¶é™å¸§çš„ä¸Šé™
  limit_on_software_decode: true     # è½¯ä»¶è§£ç æ—¶é™å¸§ï¼ˆå‡è½» CPU è´Ÿæ‹…ï¼‰
  limit_on_software_encode: true     # è½¯ä»¶ç¼–ç æ—¶é™å¸§

# ============================================================
# ç¼–ç å™¨é…ç½® (é«˜çº§è°ƒåº¦æ ¸å¿ƒ)
# ============================================================
# ğŸ’¡ è°ƒåº¦ç­–ç•¥è¯´æ˜ï¼š
#   1. NVENC å’Œ QSV åŒæ—¶å¹¶å‘å¤„ç†ä¸åŒæ–‡ä»¶
#   2. å¤±è´¥ä»»åŠ¡æ™ºèƒ½å›é€€ï¼š
#      - åŒç¼–ç å™¨å†…ï¼šç¡¬è§£+ç¡¬ç¼– â†’ è½¯è§£+ç¡¬ç¼–(é™å¸§) â†’ è½¯è§£+ç¡¬ç¼–
#      - è·¨ç¼–ç å™¨ï¼šNVENCå¤±è´¥ â†’ QSVï¼ŒQSVå¤±è´¥ â†’ NVENC
#      - æœ€ç»ˆå…œåº•ï¼šCPU è½¯ç¼–ç 
#
# ğŸ’¡ ç¡¬ä»¶ç¼–ç å™¨è¯´æ˜ï¼š
#   - nvenc: NVIDIA GPU ç¡¬ä»¶ç¼–ç ï¼ˆéœ€è¦ N å¡ï¼‰
#   - qsv: Intel Quick Sync Videoï¼ˆéœ€è¦ Intel CPU é›†æˆæ˜¾å¡ï¼‰
#   - videotoolbox: Apple ç¡¬ä»¶ç¼–ç ï¼ˆä»… macOSï¼ŒWindows ä¸å¯ç”¨ï¼‰
#   - cpu: è½¯ä»¶ç¼–ç ï¼ˆå…¼å®¹æ€§æœ€å¥½ï¼Œé€Ÿåº¦æœ€æ…¢ï¼‰

encoders:
  # å¯ç”¨çš„ç¼–ç å™¨åˆ—è¡¨ (æŒ‰ä¼˜å…ˆçº§æ’åº)
  # ğŸ“ ä¸åŒå¹³å°æ¨èé…ç½®ï¼š
  #   Windows (Nå¡+Intel): ["nvenc", "qsv"]  â† æ¨è
  #   Windows (ä»…Nå¡):     ["nvenc"]
  #   Windows (ä»…Intel):   ["qsv"]
  #   macOS:               ["videotoolbox"]
  #   Linux (Nå¡):         ["nvenc"]
  enabled:
    - nvenc
    - qsv

  # CPU ç¼–ç å™¨ä½œä¸ºå…œåº•ï¼ˆå¼ºçƒˆæ¨èå¼€å¯ï¼‰
  cpu_fallback: true

  # NVIDIA NVENC é…ç½®
  nvenc:
    enabled: true
    max_concurrent: 3    # å•å¡å¹¶å‘ä¸Šé™ï¼ˆ3-6æ ¹æ®æ˜¾å­˜è°ƒæ•´ï¼‰
    device: -1           # GPUè®¾å¤‡IDï¼Œ-1è¡¨ç¤ºè‡ªåŠ¨é€‰æ‹©

  # Intel QSV é…ç½®
  qsv:
    enabled: true
    max_concurrent: 2    # QSVå¹¶å‘ä¸Šé™ï¼ˆé€šå¸¸2-3ï¼‰
    device: null         # null è¡¨ç¤ºé»˜è®¤è®¾å¤‡

  # Apple VideoToolbox é…ç½® (ä»… macOSï¼ŒWindows ç”¨æˆ·è¯·å¿½ç•¥)
  videotoolbox:
    enabled: false       # macOS ä¸Šè®¾ä¸º true
    max_concurrent: 3

  # CPU è½¯ä»¶ç¼–ç é…ç½®
  cpu:
    enabled: true
    max_concurrent: 4    # CPUå¹¶å‘æ•°ï¼ˆæ ¹æ®æ ¸å¿ƒæ•°è°ƒæ•´ï¼‰
    preset: medium       # ç¼–ç é¢„è®¾ï¼šultrafast/fast/medium/slow

# ============================================================
# è°ƒåº¦é…ç½®ï¼ˆä»…åœ¨ --multi-gpu æ¨¡å¼ä¸‹ç”Ÿæ•ˆï¼‰
# ============================================================
scheduler:
  # æ€»å¹¶å‘ä¸Šé™ï¼ˆè·¨æ‰€æœ‰ç¼–ç å™¨ï¼‰
  # ğŸ’¡ å»ºè®®è®¾ç½®ä¸ºæ‰€æœ‰ç¼–ç å™¨ max_concurrent ä¹‹å’Œ
  #    ä¾‹å¦‚: nvenc(3) + qsv(2) = 5
  max_total_concurrent: 5

# ============================================================
# æ–‡ä»¶å¤„ç†
# ============================================================
files:
  min_size_mb: 100           # å°äºæ­¤å¤§å°è·³è¿‡ï¼ˆé¿å…å¤„ç†å°æ–‡ä»¶ï¼‰
  keep_structure: true       # ä¿æŒåŸç›®å½•ç»“æ„åˆ°è¾“å‡º
  skip_existing: true        # ç›®æ ‡æ–‡ä»¶å­˜åœ¨åˆ™è·³è¿‡

# ============================================================
# ğŸ“ å¸¸è§ä½¿ç”¨åœºæ™¯é…ç½®ç¤ºä¾‹
# ============================================================
#
# ã€åœºæ™¯1ï¼šWindows + Nå¡ + Intelé›†æ˜¾ï¼Œæœ€å¤§åŒ–å¹¶å‘ã€‘
# encoders:
#   enabled: ["nvenc", "qsv"]
#   cpu_fallback: true
#   nvenc:
#     max_concurrent: 3
#   qsv:
#     max_concurrent: 2
# scheduler:
#   max_total_concurrent: 5
#
# ã€åœºæ™¯2ï¼šä»…ä½¿ç”¨ N å¡ã€‘
# encoders:
#   enabled: ["nvenc"]
#   cpu_fallback: true
#   nvenc:
#     max_concurrent: 3
# scheduler:
#   max_total_concurrent: 3
#
# ã€åœºæ™¯3ï¼šä»…ä½¿ç”¨ Intel é›†æ˜¾ã€‘
# encoders:
#   enabled: ["qsv"]
#   cpu_fallback: true
#   qsv:
#     max_concurrent: 2
# scheduler:
#   max_total_concurrent: 2
#
# ã€åœºæ™¯4ï¼šmacOS VideoToolboxã€‘
# encoders:
#   enabled: ["videotoolbox"]
#   cpu_fallback: true
#   videotoolbox:
#     enabled: true
#     max_concurrent: 3
#
# ã€åœºæ™¯5ï¼šçº¯ CPU æ¨¡å¼ï¼ˆæ— ç¡¬ä»¶åŠ é€Ÿï¼‰ã€‘
# encoders:
#   enabled: []
#   cpu_fallback: true
#   cpu:
#     max_concurrent: 8
# scheduler:
#   max_total_concurrent: 8
